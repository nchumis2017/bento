<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <script src="./js/jquery-3.2.1.min.js"></script>
  <link rel="stylesheet" href="./css/materialize.min.css">
  <script src="./js/materialize.min.js"></script>
  <link rel="stylesheet" href="./css/main.css">

  <script src="./js/sweetalert.min.js"></script>

  <script src="https://www.gstatic.com/firebasejs/4.11.0/firebase.js"></script>

  <script type="text/javascript">
    // Initialize Firebase
    var config = {
      apiKey: "AIzaSyDHJvCW6LwYl0fih2PynaWmX3fYGqmel00",
      authDomain: "all-store-a0408.firebaseapp.com",
      databaseURL: "https://all-store-a0408.firebaseio.com",
      projectId: "all-store-a0408",
      storageBucket: "",
      messagingSenderId: "982261178985"
    };
    firebase.initializeApp(config);
  </script>
  <style media="screen">
    span {
      padding: 40px;
      font-size: 16px;
    }

    .row {
      margin-bottom: 5px;
    }

    h5 {
      font-weight: bold;
    }

    body {
      overflow-x: hidden;
    }
    span{
      margin-bottom: 10px;
    }
    i{
      color:red;
      margin-bottom: 10px
    }
    h5{
      color:blue;
    }
  </style>

  <title>index</title>
</head>

<body>


  <link href='https://fonts.googleapis.com/icon?family=Material+Icons' rel='stylesheet'>
  <nav>
    <div class='nav-wrapper #00838f cyan darken-4'>
      <a href='./index.html' class='brand-logo'>BENTO</a>
      <a href='#' data-activates='mobile-demo' class='button-collapse'><i class='material-icons' style="color:white!important;">menu</i></a>
      <ul class='right hide-on-med-and-down'>
        <li><a href='#'>個人資訊</a></li>
        <li><a href='#'>常用地址</a></li>
        <li><a href='#'>Default</a></li>
        <li><a href='#'>Default</a></li>
      </ul>
      <ul class='side-nav' id='mobile-demo'>
        <li class="#00838f cyan darken-4"><a href='#' style="color:white;">WELCOME</a></li>
        <li><a href='./sideNav/personInfo.html'>個人資訊</a></li>
        <li><a href='./sideNav/address.html'>常用地址</a></li>
        <li><a href='#'>Default</a></li>
      </ul>
    </div>
  </nav>
  </div>
  <script type="text/javascript">
    $(".button-collapse").sideNav();
  </script>


  <!-- navbar -->

  <br>
  <div class='container' id='store_list'>

    <br><br><br><br><br><br><br><br><br>
    <div class="preloader-wrapper big active">
      <div class="spinner-layer spinner-blue-only">
        <div class="circle-clipper left">
          <div class="circle"></div>
        </div>
        <div class="gap-patch">
          <div class="circle"></div>
        </div>
        <div class="circle-clipper right">
          <div class="circle"></div>
        </div>
      </div>
    </div>



    <!-- <div class='row'>

      <div class='col s6 card'>
        <div class='col s12'><img class='responsive-img' src='./image/food1.jpg' alt=></div>
        <div class='col s12'>
          <h5>123</h5>
        </div>
        <div class='col s12'><span>456465</span></div>
        <div class='col s12'><i class='material-icons'>favorite</i></div>
      </div>

      <div class='col s6 card'>
        <div class='col s12'><img class='responsive-img' src='./image/food1.jpg' alt=></div>
        <div class='col s12'>
          <h5>123</h5></div>
        <div class='col s12'><span>456465</span></div>
        <div class='col s12'><i class='material-icons'>favorite</i></div>
      </div>

    </div> -->



  </div>


  <script type="text/javascript">
    var database = firebase.database();

    database.ref("stores").once("value").then(function(snapshot) {
      var counter = snapshot.child("counter").val();
      document.getElementById("store_list").innerHTML = "";
      for (var i = 1; i <= counter; i++) {
        var temp = snapshot.child("shop" + i + "/shopName").val();
        var briefInfo = snapshot.child("shop" + i + "/shopInfo/briefInfo").val();

        var store_list = document.getElementById("store_list");



        // store_list.innerHTML +=   "<div class='col s12 m8 offset-m2 l6 offset-l3'><div class='card-panel grey lighten-5 z-depth-1'><div class='row valign-wrapper'><div class='col s2'><i class='medium material-icons'>store</i></div><div class='col s8'><a href='./store_menu.html?shop"+i+"'><span class='black-text' id='span"+i+"'>"+temp+"</span><br><br>"+briefInfo+"</a></div><div class='col s2'><i class='material-icons' onclick='javascript:favorite_store("+i+")'>favorite</i></div></div></div></div>";


          store_list.innerHTML +=
            " <div class='col s6 card'><a href='./store_menu.html?shop"+i+"'><div class='col s12'><img class='responsive-img' src='./image/food"+i+".jpg' ></div></a><div class='col s12'><h5 id='span"+i+"'>"+temp+"</h5></div><div class='col s12'><span>"+briefInfo+"</span></div><div class='col s12'><i class='material-icons' id='icon"+i+"' onclick='javascript:favorite_store("+i+")'>favorite_border</i></div></div>";


      }
    });
  </script>
  <script type="text/javascript">
    function favorite_store(i) {

      var span_i = document.getElementById("span" + i).innerHTML;
////////////////按下後更改icon
      document.getElementById("icon"+i).innerHTML = "favorite";
////////////////
      var favorite_store_counter = localStorage.favorite_store_counter;
      if (isNaN(favorite_store_counter)) {
        favorite_store_counter = 1;
        localStorage.setItem("favorite_store_counter", favorite_store_counter);
      } else {
        favorite_store_counter++;
        localStorage.setItem("favorite_store_counter", favorite_store_counter);
      }

      localStorage.setItem("favorite_store" + favorite_store_counter, span_i);

      swal(span_i + "已加入最愛");



    }
  </script>
</body>

</html>
